<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <title>ğŸš¨ Ø¥Ø±Ø³Ø§Ù„ Ø¨Ù„Ø§Øº Ø­Ø§Ø¯Ø«</title>

    <link rel="stylesheet" href="./style.css" />

    <!-- âœ… Socket.IO & SweetAlert -->
    <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <!-- âœ… ArcGIS -->
    <link
      rel="stylesheet"
      href="https://js.arcgis.com/4.30/esri/themes/light/main.css"
    />
    <script src="https://js.arcgis.com/4.30/"></script>
<script>
  document.addEventListener("DOMContentLoaded", () => {
  const token = localStorage.getItem("token");
  if (!token) {
    Swal.fire({
      icon: "warning",
      title: "ğŸš« Ù…Ù…Ù†ÙˆØ¹",
      text: "ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„ÙˆØµÙˆÙ„ Ù„Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø©",
      confirmButtonText: "ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„",
    }).then(() => {
      window.location.href = "login.html";
    });
    return; // Ù†ÙˆÙ‚Ù ØªÙ†ÙÙŠØ° Ø£ÙŠ ÙƒÙˆØ¯ Ø¢Ø®Ø±
  }

  initMap();
});
</script>

    <style>
      html,
      body,
      #map {
        padding: 0;
        margin: 0;
        height: 100%;
        width: 100%;
      }
      .sidebar {
        position: absolute;
        top: 10px;
        right: 10px;
        background: #fff;
        padding: 15px;
        border-radius: 12px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
        width: 280px;
        z-index: 99;
      }
    </style>

    <script>
      const socket = io("http://localhost:2511", {
        transports: ["websocket"],
        reconnection: true,
        reconnectionAttempts: 5,
        reconnectionDelay: 1000,
      });

      socket.on("connect", () => {
        console.log("ğŸŸ¢ Connected to server:", socket.id);
      });

      socket.on("connect_error", (err) => {
        console.error("âŒ Socket.IO error:", err.message);
      });
    </script>
  </head>
  <body>
    <div id="map"></div>
    <div class="overlay"></div>

    <div class="status-badge">
      <div class="status-indicator"></div>
      <span>Ù…ØªØµÙ„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…</span>
    </div>

    <div class="report-panel">
      <div class="panel-header">
        <div class="decorative-circle circle-1"></div>
        <div class="decorative-circle circle-2"></div>
        <span class="header-icon">ğŸš¨</span>
        <h1 class="header-title">Ù†Ø¸Ø§Ù… Ø§Ù„Ø¨Ù„Ø§ØºØ§Øª Ø§Ù„Ø·Ø§Ø±Ø¦Ø©</h1>
        <p class="header-subtitle">Ø¥Ø±Ø³Ø§Ù„ Ø¨Ù„Ø§Øº Ø­Ø§Ø¯Ø« ÙÙˆØ±ÙŠ</p>
      </div>

      <div class="panel-body">
        <form id="reportForm" onsubmit="return false;">
          <div class="form-group">
            <button id="getLocationBtn" type="button" class="btn btn-location">
              <span>ğŸ“</span>
              <span>ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆÙ‚Ø¹ÙŠ Ø§Ù„Ø­Ø§Ù„ÙŠ</span>
            </button>
          </div>

          <div class="form-group">
            <label class="form-label">
              <span class="label-icon">ğŸ‘¥</span>
              <span>Ø¹Ø¯Ø¯ Ø§Ù„Ù…ØµØ§Ø¨ÙŠÙ†</span>
            </label>
            <div class="input-wrapper">
              <input
                type="number"
                id="injuries"
                placeholder="Ø£Ø¯Ø®Ù„ Ø¹Ø¯Ø¯ Ø§Ù„Ù…ØµØ§Ø¨ÙŠÙ†"
                min="0"
              />
            </div>
          </div>

          <div class="form-group">
            <label class="form-label">
              <span class="label-icon">ğŸ“</span>
              <span>ÙˆØµÙ Ø§Ù„Ø­Ø§Ø¯Ø«</span>
            </label>
            <div class="input-wrapper">
              <textarea
                id="desc"
                placeholder="Ø§ÙƒØªØ¨ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø­Ø§Ø¯Ø« Ù‡Ù†Ø§..."
              ></textarea>
            </div>
          </div>

          <button type="submit" class="btn btn-submit">
            <span>ğŸ“¤</span>
            <span>Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨Ù„Ø§Øº Ø§Ù„Ø¢Ù†</span>
          </button>
        </form>
      </div>
    </div>

    <script src="./main.js"></script>
  </body>
</html>
